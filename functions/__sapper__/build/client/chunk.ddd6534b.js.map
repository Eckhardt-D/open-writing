{"version":3,"file":"chunk.ddd6534b.js","sources":["../../../src/components/AuthForm.svelte"],"sourcesContent":["<script>\n  export let loginMode;\n  import { user } from \"../stores.js\";\n  import { goto } from \"@sapper/app\";\n\n  let email = \"\";\n  let password = \"\";\n  let password2 = \"\";\n  let showError = false;\n  let errorMessage = \"\";\n  let showSuccess = false;\n  let successMessage = \"\";\n\n  let handleAuth = () => {\n    if (loginMode) {\n      return loginWithEmail();\n    }\n\n    signUpWithEmail();\n  };\n\n  let changeMode = () => {\n    loginMode = !loginMode;\n  };\n\n  let createError = message => {\n    showError = true;\n    errorMessage = message;\n  };\n\n  let handleErrors = code => {\n    switch (code) {\n      case \"auth/email-already-in-use\":\n        createError(\"Email already exists\");\n        break;\n      case \"auth/invalid-email\":\n        createError(\"Not a valid email address\");\n        break;\n      case \"auth/weak-password\":\n        createError(\"Your password is too weak.\");\n        break;\n      case \"auth/invalid-email\":\n        createError(\"User not found\");\n        break;\n      case \"auth/user-disabled\":\n        createError(\"You are disallowed from this site.\");\n        break;\n      case \"auth/user-not-found\":\n        createError(\"User not found\");\n        break;\n      case \"auth/wrong-password\":\n        createError(\"Incorrect e-mail or password\");\n        break;\n      default:\n        createError(\"Something went wrong\");\n        break;\n    }\n  };\n\n  let resetForm = () => {\n    email = \"\";\n    password = \"\";\n    password2 = \"\";\n  };\n\n  let signUpWithEmail = function() {\n    authentication\n      .createUserWithEmailAndPassword(email, password)\n      .then(() => {\n        authentication.currentUser\n          .sendEmailVerification({\n            url: \"https://open-writing.firebaseapp.com/auth/login\",\n            handleCodeInApp: false\n          })\n          .then(() => {\n            resetForm();\n            showSuccess = true;\n            successMessage = \"We have sent a confirmation email\";\n          })\n          .catch(error => {\n            showError = true;\n            errorMessage = \"Error sending email verification\";\n          });\n      })\n      .catch(error => handleErrors(error.code));\n  };\n\n  let loginWithEmail = function() {\n    authentication\n      .signInWithEmailAndPassword(email, password)\n      .then(() => {\n        resetForm();\n        showSuccess = true;\n        successMessage = \"Logging in\";\n      })\n      .catch(function(error) {\n        $user = false;\n        let errorCode = error.code;\n        handleErrors(errorCode);\n      });\n  };\n</script>\n\n<div class=\"card border-light mx-auto\" style=\"max-width: 25rem;\">\n  <div class=\"card-header\">\n    <h5 class=\"mb-0\">\n       {loginMode ? 'Login to your account' : 'Create an account'}\n    </h5>\n  </div>\n  <div class=\"card-body\">\n    <form>\n      <div class=\"form-group\">\n        <label for=\"email\">E-mail address</label>\n        <input\n          bind:value={email}\n          id=\"email\"\n          type=\"email\"\n          class=\"form-control\"\n          required />\n      </div>\n      <div class=\"form-group\">\n        <label for=\"password\">Password</label>\n        <input\n          bind:value={password}\n          id=\"password\"\n          type=\"password\"\n          class=\"form-control\"\n          required />\n      </div>\n      {#if !loginMode}\n        <div class=\"form-group\">\n          <label for=\"password2\">Re-enter your password</label>\n          <input\n            bind:value={password2}\n            id=\"password2\"\n            type=\"password\"\n            class=\"form-control\"\n            required />\n        </div>\n      {/if}\n      <div class=\"form-group\">\n        <button type=\"button\" on:click={handleAuth} class=\"btn btn-primary\">\n           {loginMode ? 'Login' : 'Sign Up'}\n        </button>\n      </div>\n      {#if showError}\n        <div class=\"alert alert-dismissible alert-danger\">\n          <button\n            type=\"button\"\n            class=\"close\"\n            on:click={() => (showError = false)}>\n            ×\n          </button>\n          <strong>Error!</strong>\n           {errorMessage}\n        </div>\n      {/if}\n      {#if showSuccess}\n        <div class=\"alert alert-dismissible alert-success\">\n          <button\n            type=\"button\"\n            class=\"close\"\n            on:click={() => (showSuccess = false)}>\n            ×\n          </button>\n          <strong>Success!</strong>\n           {successMessage}\n        </div>\n      {/if}\n      <button class=\"btn btn-secondary w-100\">GitHub</button>\n      <button class=\"btn btn-secondary w-100 mt-1\">Google</button>\n      <small class=\"text-muted\">\n         {loginMode ? \"Don't have an account?\" : 'Already have an account?'}\n        <span on:click={changeMode} class=\"btn btn-link pl-0\">\n           {loginMode ? 'Sign up' : 'Login'}\n        </span>\n      </small>\n    </form>\n  </div>\n</div>\n"],"names":["password2","errorMessage","ctx","successMessage","loginMode","handleAuth","changeMode","email","password","showError","showSuccess","createError","message","handleErrors","code","resetForm","signUpWithEmail","authentication","createUserWithEmailAndPassword","then","currentUser","sendEmailVerification","url","handleCodeInApp","catch","error","loginWithEmail","signInWithEmailAndPassword","$user","errorCode"],"mappings":"8yBAqIwBA,0CAAAA,8JAqBZC,+PAAAA,8IAJUC,iHAIVD,mKAYAE,mQAAAA,iJAJUD,qHAIVC,0IA5DJC,UAAY,wBAA0B,yBAoClCA,UAAY,QAAU,eA8BxBA,UAAY,yBAA2B,gCAErCA,UAAY,UAAY,cA7CxBA,qBAgBQ,qBAYE,i5EAhBkBC,2BAgChBC,qHA3DFC,0DASAC,oOAjBdJ,UAAY,wBAA0B,kDAQxBG,8BASAC,YAMVJ,+FAaAA,UAAY,QAAU,sBAGvBK,yEAYAC,iGAeDN,UAAY,yBAA2B,6DAErCA,UAAY,UAAY,qIA7K3B,cAAIA,KAIPG,EAAQ,GACRC,EAAW,GACXR,EAAY,GACZS,GAAY,EACZR,EAAe,GACfS,GAAc,EACdP,EAAiB,GAcjBQ,EAAcC,kBAChBH,GAAY,oBACZR,EAAeW,IAGbC,EAAeC,IACjB,OAAQA,GACN,IAAK,4BACHH,EAAY,wBACZ,MACF,IAAK,qBACHA,EAAY,6BACZ,MACF,IAAK,qBACHA,EAAY,8BACZ,MACF,IAAK,qBACHA,EAAY,kBACZ,MACF,IAAK,qBACHA,EAAY,sCACZ,MACF,IAAK,sBACHA,EAAY,kBACZ,MACF,IAAK,sBACHA,EAAY,gCACZ,MACF,QACEA,EAAY,0BAKdI,EAAY,eACdR,EAAQ,iBACRC,EAAW,kBACXR,EAAY,KAGVgB,EAAkB,WACpBC,eACGC,+BAA+BX,EAAOC,GACtCW,KAAK,KACJF,eAAeG,YACZC,sBAAsB,CACrBC,IAAK,kDACLC,iBAAiB,IAElBJ,KAAK,KACJJ,oBACAL,GAAc,sBACdP,EAAiB,uCAElBqB,MAAMC,kBACLhB,GAAY,oBACZR,EAAe,wCAGpBuB,MAAMC,GAASZ,EAAaY,EAAMX,QAGnCY,EAAiB,WACnBT,eACGU,2BAA2BpB,EAAOC,GAClCW,KAAK,KACJJ,oBACAL,GAAc,sBACdP,EAAiB,gBAElBqB,MAAM,SAASC,GACdG,GAAQ,WACR,IAAIC,EAAYJ,EAAMX,KACtBD,EAAagB,0LArFF,KACf,GAAIzB,EACF,OAAOsB,IAGTV,gBAGe,mBACfZ,GAAaA"}